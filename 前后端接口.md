# 前后端接口

## 用户

### 测试账号

#### 普通用户：

用户名：test

密码：111111

#### 管理员：

用户名：test

密码：111111

### Register注册（普通用户）(b:√)

- 类型：post

- 接口URL: http://localhost:8000/api/register

- f to b(前端给后端)

  ```
  {
      "name":str,
      "password":str,
      "phone":str,
      "wechat":str
  }
  ```

  例子：

  ```
  {
      "name":"test_reg",
      "password":"test",
      "wechat":"test_we"
  }
  ```

- b to f(后端给前端)

  ```
  {
  'value':int
  }
  //0成功 1s
  ```

### Login登录（普通用户+管理员）(b:√)

- 类型：post
- 接口URL: http://localhost:8000/api/login

- f to b(前端给后端)

  ```
  {
      "name":str,
      "password":str
  }
  ```

- b to f(后端给前端)

  ```
  {'value': value, 'type': type}
  //value:1用户名不存在 2密码错误 0成功
  //tyep:0普通用户 1管理员 -1未成功登录
  ```

### GetPassword（普通用户+管理员）(b:√)

- 类型：post

- f to b(前端给后端)

  ```
  {
  'username':str
  }
  ```

- b to f(后端给前端)

  ```
  {'value':int
  'password':str}
  //value:0成功 1错误
  ```

### ChangePassword（普通用户+管理员）

- 类型：post

- f to b(前端给后端)

  ```
  {
  'username':str
      "new_password":str,
  }
  ```

- b to f(后端给前端)

  ```
  {'value':int}
  //value:0成功 1错误
  ```

### GetUserInfo(普通用户)

- 类型：post

- f to b(前端给后端)

  ```
  {
  'username':str
  }
  ```

- b to f(后端给前端)

  ```
  {'value':int,
  'phone':str,
  'wechat':str}
  //value:0成功 1错误
  ```



### SetAvator设置头像

- 类型：post
- 接口URL: http://localhost:8000/api/setAvatar

- f to b(前端给后端)

  ```
  {
      "username":str,
      "photo":FILE
  }
  ```

- b to f(后端给前端)

  ```
  {
                  'value': int,
                  'photo_id': int,
              }
  ```

### GetAvator读取头像

- 类型：get
- 接口URL: http://localhost:8000/api/getAvatar/{username}

- f to b(前端给后端)

  ```
  {
      "username":str,
  }
  ```

- b to f(后端给前端)

  ```
  {
                  'value': int,
                  'path':str
              }
              //value为0的情况才会有path
  ```

### MyPosts得到自己的所有帖子

- 类型：get

- f to b(前端给后端)

  ```
  {
      "username":str,
  }
  ```

- b to f(后端给前端)

  ```
  {
              'value':int,
              //1：这个人没有发帖子 0：找到了这个人发的帖子
              'post_ids':[int]//我发布的帖子的编号
          }
  ```

### MyOrdersAsSaler得到自己作为卖家的所有订单编号

- 类型：get

- f to b(前端给后端)

  ```
  {
      "username":string,
  }
  ```

- b to f(后端给前端)

  ```
  {
              'value': int,//1代表不存在 0代表存在
              'order_ids': [int]
  }
  ```

### MyOrdersAsBuyer自己作为买家的所有订单

- 类型：get

- f to b(前端给后端)

  ```
  {
      "username":string,
  }
  ```

- b to f(后端给前端)

  ```
  {
              'value': int,//1代表不存在 0代表存在
              'order_ids': [int]
  }
  ```



## 帖子

### CreatePost 写帖子

- 类型：post
- URL: /api/createPost

- f to b(前端给后端)

  ```
  {
  'username':str
      "title":str,
      'content':str,
  }
  ```

- b to f(后端给前端)

  ```
  {'value':int,
  'post_id':int}
  //value:0成功 1错误
  ```

### DeletePost删除帖子

- 类型：post

- f to b(前端给后端)
- URL:/api/deletePost

  ```
  {
     "post_id":int
  }
  ```

- b to f(后端给前端)

  ```
  0:成功
  1：失败
  ```

### getPostCommodities 获取帖子的所有商品信息

- 类型：get

- f to b(前端给后端)

  ```
  {
      'post_id':int,
  }
  ```

- b to f(后端给前端)

  ```
  {
  "commodities":[{
                  'commodity_id': item.id,
                  'name': item.name,
                  'dc': item.description,
                  'price': item.price,
              }]
  }
  
  ```



### getPost 获取帖子内容

- 类型：get

- f to b(前端给后端)

  ```
  {
      'post_id':int,
  }
  ```

- b to f(后端给前端)

  ```
  {
              'title': post.title,
              'content': post.content,
              'user': post.user,
              'date': post.time
  }
  ```


### getAllPosts获取所有帖子的内容


- 类型：post
- URL:/api/getAllPosts

- f to b(前端给后端)

  ```
  {
      
  }
  ```

- b to f(后端给前端)

  ```
  [{
              'post_id': post.id,
              'title': post.title,
              'content': post.content,
              'user_id': post.user,
              'date': post.time
  }, ...]
  ```

## 商品 

### CreateCommodity 创建商品

- 类型：post
- URL:/api/createCommodity

- f to b(前端给后端)

  ```
  {
      "name":str,
      "dc":str,
      "price":int,
      "post_id":int
  }
  ```

- b to f(后端给前端)

  ```
  {'value': value, 'commodity_id': commodity_id}
  //value:0成功 1错误
  ```

### CheckIfOrdered查看商品状态

- 类型：post

- f to b(前端给后端)

  ```
  {
      "commodity_id":int,
  }
  ```

- b to f(后端给前端)

  ```
  0:未售出 1：已售出
  ```

### GetCommodityPictures 获取商品所有图片

- 类型：get

- f to b(前端给后端)

  ```
  {
      'commodity_id':int
  }
  ```

- b to f(后端给前端)

  ```
  {'pictures': [{
                  'photo_id': int,
                  'path': str,//大概 不确定 需要测试
              }]}
  ```

### AddCommodityPicture

- 类型：post

- f to b(前端给后端)

  ```
  {
  'commodity_id':int
  'photo':FILE
  }
  ```

- b to f(后端给前端)

  ```
  {
                  'value': int,
                  'photo_id': int,
              }
  //value 0:成功 1：失败
  //photo_id:-1:失败 否则是上传成功的photo的id
  ```

## 订单

### CreateOder 创建订单

- 类型：post

- f to b(前端给后端)

  ```
  {
      "username":str,
      "commodity_id":int
  }
  ```

- b to f(后端给前端)

  ```
  {
              'value':int,//0成功 1失败
              'order_id':int,//成功时order的id
          }
  ```

### CancelOrder

- 类型：post

- f to b(前端给后端)

  ```
  {
      "order_id":int,
  }
  ```

- b to f(后端给前端)

  ```
  {'value':int}
  //0成功 1失败
  ```

### GetOrder

- 类型：post

- f to b(前端给后端)

  ```
  {
      "order_id":int,
  }
  ```

- b to f(后端给前端)

  ```
  {
                  'value':int,//0成功1失败
                  'time': str(?),
                  'saler_id': int,
                  'buyer_id': int,
                  'commodity_id':int,
  }
  ```

##  公告

### CreateNotice

- 类型：post

- f to b(前端给后端)

  ```
  {
  'username':str
      "title":str,
      'content':str,
  }
  ```

- b to f(后端给前端)

  ```
  {'value':int
  'notice_id':int}
  //value:0成功 1错误
  ```

## 标签

### CreateTag

- 类型：post

- f to b(前端给后端)

  ```
  {
  'name':str
  }
  ```

- b to f(后端给前端)

  ```
  {'value':int
  't_id':int}
  //value:0成功 1错误
  ```



## 接口模板

### xxx

- 类型：post

- f to b(前端给后端)

  ```
  {
  'username':str
      "title":str,
      'content':str,
  }
  ```

- b to f(后端给前端)

  ```
  {'value':int
  'notice_id':int}
  //value:0成功 1错误
  ```

