# 前后端接口

## 用户

### Register注册（普通用户）

- 类型：post

- f to b(前端给后端)

  ```
  {
      "name":str,
      "password":str,
      "phone":str,
      "wechat":str
  }
  ```

- b to f(后端给前端)

  ```
  int //0成功 1不满足数据约束条件 2 此微信号已被注册 3 此用户名已被注册
  ```

### Login登录（普通用户+管理员）

- 类型：post

- f to b(前端给后端)

  ```
  {
      "name":str,
      "password":str
  }
  ```

- b to f(后端给前端)

  ```
  {'value': value, 'type': type}
  //value:1用户名不存在 2密码错误 0成功
  //tyep:0普通用户 1管理员 -1未成功登录
  ```

### SetAvator设置头像

- 类型：post

- f to b(前端给后端)

  ```
  {
      "user":str,
      "photo":FILE
  }
  ```

- b to f(后端给前端)

  ```
  {
                  'value': int,
                  'photo_id': int,
              }
  ```

### GetAvator读取头像

- 类型：post

- f to b(前端给后端)

  ```
  {
      "user":str,
  }
  ```

- b to f(后端给前端)

  ```
  {
                  'value': int,
                  'path':str
              }
              //value为0的情况才会有path
  ```

### MyPosts

- 类型：get

- f to b(前端给后端)

  ```
  {
      "user":str,
  }
  ```

- b to f(后端给前端)

  ```
  {
              'value':int,
              //1：这个人没有发帖子 0：找到了这个人发的帖子
              'post_ids':[int]//我发布的帖子的编号
          }
  ```

## 

## 帖子

### CreatePost 写帖子

- 类型：post

- f to b(前端给后端)

  ```
  {
      "title":str,
      'content'://在数据库里是text，不知道在这里应该是什么
  }
  ```

- b to f(后端给前端)

  ```
  {'value':value,'post_id':post_id}
  //value:0成功 1错误
  ```

### DeletePost删除帖子

- 类型：post

- f to b(前端给后端)

  ```
  {
     "post":int
  }
  ```

- b to f(后端给前端)

  ```
  0:成功
  1：失败
  ```

## 

### getPostCommodities 获取帖子的所有商品信息

- 类型：get

- f to b(前端给后端)

  ```
  {
      'post_id':int,
  }
  ```

- b to f(后端给前端)

  ```
  [{
                  'commodity_id': item.id,
                  'name': item.name,
                  'dc': item.description,
                  'price': item.price,
              }]
  ```



### getPost 获取帖子内容

- 类型：post

- f to b(前端给后端)

  ```
  {
      'post_id':int,
  }
  ```

- b to f(后端给前端)

  ```
  {
              'title': post.title,
              'content': post.content,
              'user': post.user,
              'date': post.time
  }
  ```

## 商品 

### CreateCommodity 创建商品

- 类型：post

- f to b(前端给后端)

  ```
  {
      "name":str,
      "dc":str,
      "price":int,
      "post_id":int
  }
  ```

- b to f(后端给前端)

  ```
  {'value': value, 'commodity_id': commodity_id}
  //value:0成功 1错误
  ```

### CheckIfOrdered查看商品状态

- 类型：post

- f to b(前端给后端)

  ```
  {
      "commodity":int,
  }
  ```

- b to f(后端给前端)

  ```
  0:未售出 1：已售出
  ```

### GetCommodityPictures 获取商品所有图片

- 类型：get

- f to b(前端给后端)

  ```
  {
      'commodity_id':int
  }
  ```

- b to f(后端给前端)

  ```
  {'pictures': [{
                  'photo_id': int,
                  'path': str,//大概 不确定 需要测试
              }]}
  ```

### AddCommodityPicture

- 类型：post

- f to b(前端给后端)

  ```
  path=req.FILES.get('photo'),//文件
  commodity=req.data['commodity'],//int commodity的id
  ```

- b to f(后端给前端)

  ```
  {
                  'value': int,
                  'photo_id': int,
              }
  //value 0:成功 1：失败
  //photo_id:-1:失败 否则是上传成功的photo的id
  ```

## 订单

### CreateOder 创建订单

- 类型：post

- f to b(前端给后端)

  ```
  {
      "user":str,
      "commodity":int
  }
  ```

- b to f(后端给前端)

  ```
  {
              'value':int,//0成功 1失败
              'order':int,//成功时order的id
          }
  ```

## 

## 接口模板

### xxx

- 类型：post

- f to b(前端给后端)

  ```
  {
      "name":str,
  }
  ```

- b to f(后端给前端)

  ```
  int //
  ```

## 存疑

user是从req.session里读取，还是前端传入

以及如何删除session里的内容
